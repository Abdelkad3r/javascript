{"ast":null,"code":"var _jsxFileName = \"/Users/apple/Desktop/javascript/bchat/src/Store.js\";\nimport React from 'react';\nimport io from 'socket.io-client';\nexport const CTX = React.createContext();\nconst initState = {\n  general: [{\n    from: 'swedish_scott',\n    msg: 'hello'\n  }, {\n    from: 'mo',\n    msg: 'hello'\n  }, {\n    from: 'fati',\n    msg: 'hello'\n  }],\n  topic2: [{\n    from: 'swedish_scott',\n    msg: 'hello'\n  }, {\n    from: 'swedish_scott',\n    msg: 'hello'\n  }, {\n    from: 'swedish_scott',\n    msg: 'hello'\n  }]\n};\n\nfunction reducer(state, action) {\n  switch (action.type) {\n    case 'RECEIVE_MESSAGE':\n      return { ...state,\n        [action.payload.topic]: [...state[action.payload.topic], {\n          from: action.payload.from,\n          msg: action.payload.msg\n        }]\n      };\n\n    default:\n      return state;\n  }\n}\n\nlet socket;\n\nfunction sendChatAction(value) {\n  socket.emit('chat message', value);\n}\n\nfunction Store(props) {\n  const [allChats, dispatch] = React.useReducer(reducer, initState);\n\n  if (!socket) {\n    socket = io(':3001');\n    socket.on('chat message', function (msg) {\n      dispatch({\n        type: 'RECEIVE_MESSAGE',\n        payload: msg\n      });\n    });\n  }\n\n  const user = 'swedish_scott' + Math.random(100).toFixed(2);\n  return React.createElement(CTX.Provider, {\n    value: {\n      allChats,\n      sendChatAction,\n      user\n    },\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 56\n    },\n    __self: this\n  }, props.children);\n}\n\nexport default Store;","map":{"version":3,"sources":["/Users/apple/Desktop/javascript/bchat/src/Store.js"],"names":["React","io","CTX","createContext","initState","general","from","msg","topic2","reducer","state","action","type","payload","topic","socket","sendChatAction","value","emit","Store","props","allChats","dispatch","useReducer","on","user","Math","random","toFixed","children"],"mappings":";AAAA,OAAOA,KAAP,MAAkB,OAAlB;AACA,OAAOC,EAAP,MAAe,kBAAf;AAEA,OAAO,MAAMC,GAAG,GAAGF,KAAK,CAACG,aAAN,EAAZ;AAEP,MAAMC,SAAS,GAAG;AACdC,EAAAA,OAAO,EAAE,CACL;AAACC,IAAAA,IAAI,EAAE,eAAP;AAAwBC,IAAAA,GAAG,EAAE;AAA7B,GADK,EAEL;AAACD,IAAAA,IAAI,EAAE,IAAP;AAAaC,IAAAA,GAAG,EAAE;AAAlB,GAFK,EAGL;AAACD,IAAAA,IAAI,EAAE,MAAP;AAAeC,IAAAA,GAAG,EAAE;AAApB,GAHK,CADK;AAMdC,EAAAA,MAAM,EAAE,CACJ;AAACF,IAAAA,IAAI,EAAE,eAAP;AAAwBC,IAAAA,GAAG,EAAE;AAA7B,GADI,EAEJ;AAACD,IAAAA,IAAI,EAAE,eAAP;AAAwBC,IAAAA,GAAG,EAAE;AAA7B,GAFI,EAGJ;AAACD,IAAAA,IAAI,EAAE,eAAP;AAAwBC,IAAAA,GAAG,EAAE;AAA7B,GAHI;AANM,CAAlB;;AAYA,SAASE,OAAT,CAAiBC,KAAjB,EAAwBC,MAAxB,EAAgC;AAC5B,UAAOA,MAAM,CAACC,IAAd;AACI,SAAK,iBAAL;AACI,aAAO,EACF,GAAGF,KADD;AAEF,SAACC,MAAM,CAACE,OAAP,CAAeC,KAAhB,GAAwB,CACpB,GAAGJ,KAAK,CAACC,MAAM,CAACE,OAAP,CAAeC,KAAhB,CADY,EAEpB;AACGR,UAAAA,IAAI,EAAEK,MAAM,CAACE,OAAP,CAAeP,IADxB;AAEGC,UAAAA,GAAG,EAAEI,MAAM,CAACE,OAAP,CAAeN;AAFvB,SAFoB;AAFtB,OAAP;;AAUJ;AACI,aAAOG,KAAP;AAbR;AAeH;;AAED,IAAIK,MAAJ;;AAEA,SAASC,cAAT,CAAwBC,KAAxB,EAA+B;AAC3BF,EAAAA,MAAM,CAACG,IAAP,CAAY,cAAZ,EAA4BD,KAA5B;AACH;;AAED,SAASE,KAAT,CAAeC,KAAf,EAAsB;AAElB,QAAM,CAACC,QAAD,EAAWC,QAAX,IAAuBtB,KAAK,CAACuB,UAAN,CAAiBd,OAAjB,EAA2BL,SAA3B,CAA7B;;AAEA,MAAI,CAACW,MAAL,EAAa;AACTA,IAAAA,MAAM,GAAGd,EAAE,CAAC,OAAD,CAAX;AACAc,IAAAA,MAAM,CAACS,EAAP,CAAU,cAAV,EAA0B,UAASjB,GAAT,EAAc;AACpCe,MAAAA,QAAQ,CAAC;AAACV,QAAAA,IAAI,EAAE,iBAAP;AAA0BC,QAAAA,OAAO,EAAEN;AAAnC,OAAD,CAAR;AACH,KAFD;AAGH;;AAED,QAAMkB,IAAI,GAAG,kBAAkBC,IAAI,CAACC,MAAL,CAAY,GAAZ,EAAiBC,OAAjB,CAAyB,CAAzB,CAA/B;AAEA,SACI,oBAAC,GAAD,CAAK,QAAL;AAAc,IAAA,KAAK,EAAE;AAACP,MAAAA,QAAD;AAAWL,MAAAA,cAAX;AAA2BS,MAAAA;AAA3B,KAArB;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KACKL,KAAK,CAACS,QADX,CADJ;AAKH;;AAED,eAAeV,KAAf","sourcesContent":["import React from 'react'\nimport io from 'socket.io-client'\n\nexport const CTX = React.createContext();\n\nconst initState = {\n    general: [\n        {from: 'swedish_scott', msg: 'hello'},\n        {from: 'mo', msg: 'hello'},\n        {from: 'fati', msg: 'hello'},\n    ],\n    topic2: [\n        {from: 'swedish_scott', msg: 'hello'},\n        {from: 'swedish_scott', msg: 'hello'},\n        {from: 'swedish_scott', msg: 'hello'},\n    ]\n}\nfunction reducer(state, action) {\n    switch(action.type) {\n        case 'RECEIVE_MESSAGE': \n            return {\n                 ...state,\n                 [action.payload.topic]: [\n                     ...state[action.payload.topic],\n                     {\n                        from: action.payload.from, \n                        msg: action.payload.msg\n                    }\n                 ]\n            }\n        default:\n            return state \n    }\n}\n\nlet socket;\n\nfunction sendChatAction(value) {\n    socket.emit('chat message', value);\n}\n\nfunction Store(props) {\n\n    const [allChats, dispatch] = React.useReducer(reducer , initState);\n\n    if (!socket) {\n        socket = io(':3001');\n        socket.on('chat message', function(msg) {\n            dispatch({type: 'RECEIVE_MESSAGE', payload: msg});\n        });\n    }\n\n    const user = 'swedish_scott' + Math.random(100).toFixed(2)\n\n    return (\n        <CTX.Provider value={{allChats, sendChatAction, user}}>\n            {props.children}\n        </CTX.Provider> \n    )\n}\n\nexport default Store\n "]},"metadata":{},"sourceType":"module"}